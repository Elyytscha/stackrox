{
  "id": "fb8f8732-c31d-496b-8fb1-d5abe6056e27",
  "name": "Pod Service Account Token Automatically Mounted",
  "description": "Protect pod default service account tokens from compromise by minimizing the mounting of the default service account token to only those pods whose application requires interaction with the Kubernetes API.",
  "rationale": "By default, Kubernetes automatically provisions a service account for each pod and mounts the secret at runtime. This service account is not typically used. If this pod is compromised and the compromised user has access to the service account, the service account could be used to escalate privileges within the cluster. To reduce the likelihood of privilege escalation this service account should not be mounted by default unless the pod requires direct access to the Kubernetes API as part of the pods functionality.",
  "remediation": "Add `automountServiceAccountToken: false` or a value distinct from 'default' for the `serviceAccountName` key to the deployment's Pod configuration.",
  "categories": [
    "Security Best Practices",
    "Privileges"
  ],
  "lifecycleStages": [
    "DEPLOY"
  ],
  "exclusions": [
    {
      "name": "Don't alert on deployment blackbox-exporter in  openshift-route-monitor-operator namespace",
      "deployment": {
        "name": "blackbox-exporter",
        "scope": {
          "namespace": "openshift-route-monitor-operator"
        }
      }
    },
    {
      "name": "Don't alert on deployment token-refresher in openshift-monitoring namespace",
      "deployment": {
        "name": "token-refresher",
        "scope": {
          "namespace": "openshift-monitoring"
        }
      }
    },
    {
      "name": "Don't alert on deployment downloads in openshift-console namespace",
      "deployment": {
        "name": "downloads",
        "scope": {
          "namespace": "openshift-console"
        }
      }
    },
    {
      "name": "Don't alert on deployment csi-snapshot-webhook in openshift-cluster-storage-operator namepsace",
      "deployment": {
        "name": "csi-snapshot-webhook",
        "scope": {
          "namespace": "openshift-cluster-storage-operator"
        }
      }
    },
    {
      "name": "Don't alert on deployment network-operator in openshift-network-operator namespace",
      "deployment": {
        "name": "network-operator",
        "scope": {
          "namespace": "openshift-network-operator"
        }
      }
    },
    {
      "name": "Don't alert on deployment  network-check-target in openshift-network-diagnostics Namespace",
      "deployment": {
        "name": "network-check-target",
        "scope": {
          "namespace": "openshift-network-diagnostics"
        }
      }
    },
    {
      "name": "Don't alert on deployment machine-config-operator in openshift-machine-config-operator Namespace",
      "deployment": {
        "name": "machine-config-operator",
        "scope": {
          "namespace": "openshift-machine-config-operator"
        }
      }
    },
    {
      "name": "Don't alert on deployment ingress-canary in openshift-ingress-canary Namespace",
      "deployment": {
        "name": "ingress-canary",
        "scope": {
          "namespace": "openshift-ingress-canary"
        }
      }
    }
  ],
  "severity": "MEDIUM_SEVERITY",
  "policyVersion": "1.1",
  "policySections": [
    {
      "policyGroups": [
        {
          "fieldName": "Automount Service Account Token",
          "values": [
            {
              "value": "true"
            }
          ]
        },
        {
          "fieldName": "Service Account",
          "values": [
            {
              "value": "default"
            }
          ]
        },
        {
          "fieldName": "Namespace",
          "negate": true,
          "values": [
            {
              "value": "kube-system"
            }
          ]
        }
      ]
    }
  ],
  "criteriaLocked": true,
  "mitreVectorsLocked": true,
  "isDefault": true
}

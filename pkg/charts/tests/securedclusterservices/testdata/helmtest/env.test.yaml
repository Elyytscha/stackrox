tests:
- name: "OpenShift resources should be created with env.openshift=true"
  set:
    env.openshift: true
  expect: |
    .securitycontextconstraints.sensor != null
    .securitycontextconstraints.collector != null
    .securitycontextconstraints["admission-control"] != null
    envVars(.deployments.sensor; "sensor")["ROX_OPENSHIFT_API"] == "true"

- name: "OpenShift resources should not be created by default"
  expect: |
    .securitycontextconstraints == null
    envVars(.deployments.sensor; "sensor")["ROX_OPENSHIFT_API"] != "true"

- name: "OpenShift resources should not be created with env.openshift=false"
  set:
    env.openshift: false
  expect: |
    .securitycontextconstraints == null
    envVars(.deployments.sensor; "sensor")["ROX_OPENSHIFT_API"] != "true"

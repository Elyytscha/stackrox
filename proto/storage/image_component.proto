syntax = "proto3";

option go_package = "storage";
option java_package = "io.stackrox.proto.storage";

import "protobuf/gogoproto/gogo.proto";

package storage;

message ImageComponent {
    message License {
        string name = 1;
        string type = 2;
        string url  = 3;
    }

    string                         id           = 1 [(gogoproto.moretags) = "search:\"Component ID,store\""];
    string                         name         = 2 [(gogoproto.moretags) = "search:\"Component Name,store\""];
    string                         version      = 3 [(gogoproto.moretags) = "search:\"Component Version,store\""];
    License                        license      = 4;
    int64                          priority     = 5;
    enum SourceType {
        OS     = 0;
        PYTHON = 1;
        JAVA   = 2;
        RUBY   = 3;
        NODEJS = 4;
    }
    SourceType                     source       = 6 [(gogoproto.moretags) = "search:\"Component Source,store\""];
    string                         location     = 7 [(gogoproto.moretags) = "search:\"Component Location,store\""];
}

message ComponentCVEEdge {
    // base 64 encoded Component:CVE ids.
    string id = 1;

    bool is_fixable = 2 [(gogoproto.moretags) = "search:\"Fixable,store\""];

    // Whether there is a version the CVE is fixed in the component.
    oneof has_fixed_by {
        string fixed_by = 3 [(gogoproto.moretags) = "search:\"Fixed By,store\""];
    }
}
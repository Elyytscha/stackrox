syntax = "proto3";

option go_package = "central";

import "google/protobuf/timestamp.proto";
import "api/v1/network_enums.proto";

package central;

message NetworkConnectionInfoIndicator {
    // The source deployment ID of the network connection
    string src_deployment_id                      = 1;
    // The destination deployment ID of the network connection
    string dst_deployment_id                      = 2;
    uint32 dst_port                               = 3;         // may be 0 if not applicable (e.g., icmp).
    v1.L4Protocol l4protocol                      = 4;

    google.protobuf.Timestamp last_seen_timestamp = 5;
}

message NetworkConnectionIndicatorUpdate {
    // Network connections that were updated from the last time state was sent to Central.
    repeated NetworkConnectionInfoIndicator updated      = 1;
    google.protobuf.Timestamp time      = 2;

}
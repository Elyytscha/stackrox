syntax = "proto3";

option go_package = "sensor";

import "internalapi/compliance/compliance_data.proto";
import "storage/container_runtime.proto";
import "api/v1/empty.proto";

package sensor;

message GetScrapeConfigRequest {
    string node_name = 1;
    string scrape_id = 2;
}

message ScrapeConfig {
    storage.ContainerRuntime container_runtime = 1;
}

// A Sensor service that allows node scrapes to report results.
service ComplianceService {
    rpc GetScrapeConfig (GetScrapeConfigRequest) returns (ScrapeConfig);
    rpc PushComplianceReturn (compliance.ComplianceReturn) returns (v1.Empty);
}

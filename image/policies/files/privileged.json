{
  "id": "fe9de18b-86db-44d5-a7c4-74173ccffe2e",
  "name": "Privileged Container",
  "description": "Alert on deployments with containers running in privileged mode",
  "severity": "MEDIUM_SEVERITY",
  "lifecycle_stages": ["DEPLOY"],
  "categories": ["Privileges"],
  "fields": {
    "privileged": true
  },
  "rationale": "Containers running as privileged represent greater post-exploitation risk by allowing an attacker to access all host devices, run a daemon in the container, etc.",
  "remediation": "Verify that privileged capabilities are required and cannot be provided with a subset of other controls.",
  "whitelists": [
    {
      "name": "Don't alert on StackRox Prevent",
      "deployment": {
        "scope": {
          "label": {
            "key": "com.docker.stack.namespace",
            "value": "prevent"
          }
        }
      }
    },
    {
      "name": "Don't alert on the stackrox namespace",
      "deployment": {
        "scope": {
          "namespace": "stackrox"
        }
      }
    },
    {
      "name": "Don't alert on kube-system namespace",
      "deployment": {
        "scope": {
          "namespace": "kube-system"
        }
      }
    },
    {
      "name": "Don't alert on openshift-node namespace",
      "deployment": {
        "scope": {
          "namespace": "openshift-node"
        }
      }
    },
    {
      "name": "Don't alert on openshift-sdn namespace",
      "deployment": {
        "scope": {
          "namespace": "openshift-sdn"
        }
      }
    }
  ]
}

{
  "name": "No resource requests or limits specified",
  "description": "Alert on deployments that have containers without resource requests and limits",
  "severity": "MEDIUM_SEVERITY",
  "lifecycle_stages": ["DEPLOY"],
  "categories": ["DevOps Best Practices"],
  "fields": {
    "containerResourcePolicy": {
      "cpuResourceRequest": {
        "op": "EQUALS",
        "value": 0
      },
      "cpuResourceLimit": {
        "op": "EQUALS",
        "value": 0
      },
      "memoryResourceRequest": {
        "op": "EQUALS",
        "value": 0
      },
      "memoryResourceLimit": {
        "op": "EQUALS",
        "value": 0
      }
    }
  },
  "rationale": "If a container does not have resource requests or limits specified then the host may become over-provisioned.",
  "remediation": "Specify the requests and limits of CPU and Memory for your deployment.",
  "whitelists": [
    {
      "name": "Don't alert on kube-system namespace",
      "deployment": {
        "scope": {
          "namespace": "kube-system"
        }
      }
    },
    {
      "name": "Don't alert on ucp-agent",
      "deployment": {
        "name": "ucp-agent"
      }
    },
    {
      "name": "Don't alert on ucp-agent-win",
      "deployment": {
        "name": "ucp-agent-win"
      }
    },
    {
      "name": "Don't alert on ucp-agent-s390x",
      "deployment": {
        "name": "ucp-agent-s390x"
      }
    },
    {
      "name": "Don't alert on benchmark",
      "deployment": {
        "name": "benchmark"
      }
    }
  ]
}

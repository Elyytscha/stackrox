{
  "name": "Mount Docker Socket",
  "description": "Alert on deployments with volume mount on docker socket",
  "severity": "MEDIUM_SEVERITY",
  "lifecycle_stages": ["DEPLOY"],
  "categories": ["Security Best Practices"],
  "fields": {
    "volume_policy": {
      "source": "^/var/run/docker.sock$"
    }
  },
  "rationale": "Mounting /var/run/docker.sock implies container access to the docker daemon. This expands the attack surface of the container and gives an intruder an opportunity to break containment if the daemon is not properly secured.",
  "remediation": "Access Orchestrator APIs to launch new services or access node data.",
  "whitelists": [
    {
      "name": "Don't alert on StackRox Prevent",
      "deployment": {
        "scope": {
          "label": {
            "key": "com.docker.stack.namespace",
            "value": "prevent"
          }
        }
      }
    },
    {
      "name": "Don't alert on StackRox Detect and Respond",
      "deployment": {
        "scope": {
          "label": {
            "key": "com.docker.stack.namespace",
            "value": "stackrox"
          }
        }
      }
    },
    {
      "name": "Don't alert on StackRox collector",
      "deployment": {
        "name": "collector",
        "scope": {
          "namespace": "stackrox"
        }
      }
    },
    {
      "name": "Don't alert on ucp-agent",
      "deployment": {
        "name": "ucp-agent"
      }
    },
    {
      "name": "Don't alert on ucp-agent-s390x",
      "deployment": {
        "name": "ucp-agent-s390x"
      }
    },
    {
      "name": "Don't alert on benchmark",
      "deployment": {
        "name": "benchmark"
      }
    }
  ]
}

{
    "name": "Process Targeting Cluster Kubernetes Docker Stats Endpoint",
    "description": "Detects misuse of the Kubernetes docker stats endpoint",
    "categories": ["Kubernetes"],
    "severity": "HIGH_SEVERITY",
    "lifecycle_stages": ["RUN_TIME"],
    "fields": {
      "process_policy": {
        "args": "(http?://)?\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:4194/*"
      }
    },
  "rationale": "A pod communicating to a Kubernetes API from via command line is highly irregular",
  "remediation": "Look for open ports that may allow remote execution. Remove network utilities like curl and wget that allow these connections. Consider a firewall deny ingress firewall rule to the node serving the API"
}

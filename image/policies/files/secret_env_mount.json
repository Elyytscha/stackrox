{
  "id": "a788556c-9268-4f30-a114-d456f2380818",
  "name": "Secret Mounted as Environment Variable",
  "description": "Alert on deployments with Kubernetes secret mounted as environment variable",
  "disabled": true,
  "severity": "HIGH_SEVERITY",
  "lifecycle_stages": [
    "DEPLOY"
  ],
  "categories": [
    "Security Best Practices"
  ],
  "fields": {
    "env": {
      "envVarSource": "SECRET_KEY"
    }
  },
  "rationale": "Using secrets in environment variables may allow inspection into your secrets from the host.",
  "remediation": "Migrate your secrets from environment variables to your security team's secret management solution.",
  "whitelists": [
    {
      "name": "Don't alert on StackRox scanner-v2 database",
      "deployment": {
        "name": "scanner-v2-db",
        "scope": {
          "namespace": "stackrox"
        }
      }
    }
  ]
}

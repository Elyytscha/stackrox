{
  "name": "Don't use environment variables with secrets",
  "description": "Alert on deployments with environment variables that contain 'SECRET'",
  "severity": "HIGH_SEVERITY",
  "lifecycle_stages": ["DEPLOY"],
  "categories": ["Security Best Practices"],
  "fields": {
    "env": {
      "key": ".*SECRET.*",
      "value": ".*"
    }
  },
  "rationale": "Using secrets in environment variables may allow inspection into your secrets from the host or even through the orchestrator UI.",
  "remediation": "Migrate your secrets from environment variables to orchestrator secrets or your security team's secret management solution.",
  "whitelists": [
    {
      "name": "Don't alert on StackRox Detect and Respond",
      "deployment": {
        "scope": {
          "label": {
            "key": "com.docker.stack.namespace",
            "value": "stackrox"
          }
        }
      }
    }
  ]
}
